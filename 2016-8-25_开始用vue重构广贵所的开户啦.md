### 2016-8-25 开始用vue重构广贵所的开户啦

能够在公司参与到重构开户流程这样的工作，还是很开心的。毕竟之前一直都在做运营活动，运营活动开发周期短，工作复杂程度也比较低，因为对开发流程比较熟悉的缘故，很多时候感觉做完一个需求，完全是不需要任何思考的。讲真，前一阵子对这个问题很是苦恼，但是苦于运营活动没有一个固定的流程，所以也就很难构建一个运营活动页的制作发布工具。而且个人的能力受限，对后台java和freemarker是怎么生效的并不了解，对这个流程的模糊，让我感觉无从下手。不过我至今仍然没有放弃这个想法，仍然在寻找一些类似的解决方案。

说到这里，感觉自己到英语实在成问题，已经成为了自己学习前端技术的阻碍，需要翻译一些文章来提高自己到英语阅读水平。

回过头来说vue。其实从去年年底的时候就开始接触vue了，通读了vue1.0的官方教程，然后跟着一些文章的讲解做了一个简单的单页面应用demo。然后由于项目里没有使用，也就暂时搁置了。直到前一阵子，推广同事的一个需求要求仿照客户端里的交易页面重写一个模拟交易页面，交易页面上需要展示大量交易数据。leader决定使用vue来写这个页面，讲真能够参与进来我还是很开心的，毕竟自己学的东西终于能够应用在实践里了。

在模拟盘里，我做的最多的还是在vue组件上绑定方法，发送异步请求；读取接口，然后把接口里读到到数据传到vue模版中，最终在页面上展示出来；父子组件之间的通信也是单向的。终归是比较简单的应用，没有更复杂的场景了。

直到最近开始重构开户，讲真在开户流程的重构里，我参与重构了其中两步（开户流程分为三步，另外一步和项目架子的搭建是跟我合作的同事做的）。开户的应用场景更为复杂一些，在这个过程中，读同事写的代码、跟同事合作、以及自己解决问题的过程都让自己有很多感悟。

* 开户的代码之前是leader写的，leader向来很重视代码的干净易读。他的代码无论是注释还是命名都更容易让人理解一些。去年刚入职不久的时候，变量的命名和编码的规范是我被leader说的最多的地方，现在在不断地追求让自己的代码写的更易读一些。不过自己现在仍然没有很好的写注释的习惯。
* 对vue的API还是不太熟悉。之前在写模拟交易页面的时候，总是忍不住想用jquery的选择器去进行dom节点操作，总是会忘记使用数值绑定、忘记在组件上直接绑定方法。这次重构开户的时候，读了同事重构的南交所开户代码，潜移默化地对自己使用vue也有很多帮助。
* 这次的开户代码里，有一个应用场景是需要我写一个子组件弹窗，点击父组件，弹出子组件弹窗，并且同时发送异步请求。这时，我用了$broadcast事件广播，在子组件中触发一个事件，并在这个事件中发送异步请求。然后读了同事的代码后发现，可以用属性传递父组件被点击的状态，然后在子组件中watch这个属性就可以实现了。点击子组件弹窗不同的按钮需要通知到父组件。对API不够了解的我，使用了事件$dispatch。后来咨询了同事后发现，原来可以直接使用父子组件之间的属性值双向绑定，就可以把子组件的状态通知到父组件，并在父组件中watch这个反向通知的属性即可。一个问题，watch似乎只在被观察的属性值发生变化的时候才生效。